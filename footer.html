<!-- Rodapé -->
<footer class="site-footer">
    <div class="footer-content">
        <a href="#" class="back-button" id="footerBackButton" data-translate="back-button" style="display: none;">← Voltar</a>
        
        <a href="https://discord.gg/PwvzkGx" target="_blank" class="discord-banner">
            <img src="discord.png" alt="Discord" class="discord-logo">
            <div class="discord-text">
                <span data-translate="join-our">Junte-se ao nosso</span>
                <span>Discord</span>
            </div>
        </a>
        
        <div class="footer-divider"></div>
        
        <div class="footer-info">
            <p><strong>NGT Server</strong></p>
            <p class="footer-text-clickable" id="changelogTrigger" data-translate="footer-text">© 2025 - Sistema de Gerenciamento de Mecânicas</p>
        </div>
    </div>
</footer>

<!-- Modal de Changelog/Patch Notes -->
<div class="changelog-modal" id="changelogModal">
    <div class="changelog-modal-content">
        <div class="changelog-modal-header">
            <h2 data-translate="changelog-title">Update History</h2>
            <button class="close-modal-btn" id="closeChangelogBtn">&times;</button>
        </div>
        <div class="changelog-content">
            <div class="changelog-section">
                <h3>August 2025</h3>
                <ul>
                    <li><strong>Flashcard System:</strong> Added functionality to create and manage custom mechanics</li>
                    <li><strong>CM Mode:</strong> Support for Challenge Mode mechanics in raids and fractals</li>
                    <li><strong>Quick Copy:</strong> Button to copy mechanic text to the clipboard</li>
                    <li><strong>Responsive Design:</strong> Interface adapted for desktop and mobile</li>
                    <li><strong>Import/Export System:</strong> You can now export and import all your custom mechanics in a single JSON file</li>
                    <li><strong>Settings Button:</strong> New gear button on all pages for quick access to settings</li>
                    <li><strong>Multilingual Support:</strong> Full translation system for Portuguese, English, and Spanish</li>
                    <li><strong>UI Improvements:</strong> Modernized interface with gradients and smooth animations</li>
                    <li><strong>Content Organization:</strong> All Fractal, Strike, and Raid mechanics organized and translated</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
// Configurar modal de changelog
(function() {
    function setupChangelogModal() {
        const changelogTrigger = document.getElementById('changelogTrigger');
        const changelogModal = document.getElementById('changelogModal');
        const closeBtn = document.getElementById('closeChangelogBtn');
        
        if (changelogTrigger && changelogModal) {
            // Abrir modal ao clicar no texto do footer
            changelogTrigger.addEventListener('click', function() {
                changelogModal.style.display = 'flex';
            });
            
            // Fechar modal ao clicar no X
            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    changelogModal.style.display = 'none';
                });
            }
            
            // Fechar modal ao clicar fora do conteúdo
            changelogModal.addEventListener('click', function(event) {
                if (event.target === changelogModal) {
                    changelogModal.style.display = 'none';
                }
            });
        }
    }
    
    // Executar setup
    setupChangelogModal();
    
    // Backup se o DOM ainda estiver carregando
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupChangelogModal);
    }
})();

// Configurar botão Voltar no footer baseado na página atual
(function() {
    // Executar imediatamente quando o footer for inserido
    function setupBackButton() {
        const backButton = document.getElementById('footerBackButton');
        if (!backButton) return;
        
        const path = window.location.pathname;
        const filename = path.split('/').pop();
        
        console.log('Setup back button - path:', path, 'filename:', filename);
        
        // Mapear páginas que precisam do botão Voltar
        const backButtonConfig = {
            // Páginas principais voltam para index
            'fractals.html': 'index.html',
            'strikes.html': 'index.html',
            'raids.html': 'index.html',
            'meta-events.html': 'index.html',
            'menu4.html': 'meta-events.html', // Redirect antigo
            // Páginas legacy menu1-item
            'menu1-item1.html': 'fractals.html',
            'menu1-item2.html': 'fractals.html',
            'menu1-item3.html': 'fractals.html',
            'menu1-item4.html': 'fractals.html',
            'menu1-item5.html': 'fractals.html',
            // Páginas legacy menu2-item
            'menu2-item1.html': 'strikes.html',
            // Páginas legacy menu3-item
            'menu3-item1.html': 'raids.html'
        };
        
        // Verificar se está em uma subpasta (fractals/, strikes/, raids/)
        if (path.includes('/fractals/')) {
            backButton.href = '../fractals.html';
            backButton.style.display = 'inline-block';
            console.log('Detected fractals subfolder, href set to:', backButton.href);
        }
        else if (path.includes('/strikes/')) {
            backButton.href = '../strikes.html';
            backButton.style.display = 'inline-block';
            console.log('Detected strikes subfolder, href set to:', backButton.href);
        }
        else if (path.includes('/raids/')) {
            backButton.href = '../raids.html';
            backButton.style.display = 'inline-block';
            console.log('Detected raids subfolder, href set to:', backButton.href);
        }
        // Verificar páginas específicas (principais e legacy)
        else if (backButtonConfig[filename]) {
            backButton.href = backButtonConfig[filename];
            backButton.style.display = 'inline-block';
            console.log('Detected specific page, href set to:', backButton.href);
        }
    }
    
    // Tentar executar imediatamente
    setupBackButton();
    
    // E também no DOMContentLoaded como backup
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupBackButton);
    }
})();
</script>
